import time
import harshexit
import runonce

# Stop the NM
gotlock = runonce.getprocesslock("seattlenodemanager")
if gotlock == True:
  # No NM running? This is an error
  logstream.write("FAILURE: Successfully acquired the NM process lock! The NM should be running!\n")
else:
  if gotlock:
    # Kill the NM
    harshexit.portablekill(gotlock)
    # Allow the sockets to cleanup and the locks to be cleaned
    time.sleep(3)